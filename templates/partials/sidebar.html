{% load static %}
{% load custom_tags %}

<nav class="sidenav navbar navbar-vertical fixed-left navbar-expand-xs navbar-light bg-white" id="sidenav-main">
    <div class="scrollbar-inner">
        <!-- Brand -->
        <div class="sidenav-header d-flex align-items-center">
            <a class="navbar-brand" href="{% url 'archive:dashboard' %}">
                <img src="{% static 'images/brand/default.png' %}" class="navbar-brand-img" alt="Logo">
                <!-- <span class="ml-2 font-weight-bold">Arsip Digital</span> -->
            </a>
            <div class="ml-auto">
                <!-- Sidenav toggler -->
                <div class="sidenav-toggler d-none d-xl-block" data-action="sidenav-unpin" data-target="#sidenav-main">
                    <div class="sidenav-toggler-inner">
                        <i class="sidenav-toggler-line"></i>
                        <i class="sidenav-toggler-line"></i>
                        <i class="sidenav-toggler-line"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="navbar-inner">
            <!-- Collapse -->
            <div class="collapse navbar-collapse" id="sidenav-collapse-main">

                <!-- Nav items -->
                <ul class="navbar-nav">
                    <!-- Dashboard -->
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'archive:dashboard' %}">
                            <i class="fa-solid fa-chart-line text-default"></i>
                            <span class="nav-link-text">Dashboard</span>
                        </a>
                    </li>

                    <!-- Documents -->
                    <li class="nav-item">
                        <a class="nav-link {% if 'document' in request.resolver_match.url_name %}active{% endif %}" href="{% url 'archive:document_list' %}">
                            <i class="fa-solid fa-folder-open text-info"></i>
                            <span class="nav-link-text">Semua Dokumen</span>
                            {% if sidebar_total_documents %}
                            <span class="badge badge-sm badge-pill badge-info ml-auto">
                                {{ sidebar_total_documents }}
                            </span>
                            {% endif %}
                        </a>
                    </li>
                </ul>
                
                <!-- Divider -->
                <hr class="my-3">
                
                <!-- Navigation Heading -->
                <h6 class="navbar-heading p-0 text-muted">
                    <span class="docs-normal">Kategori</span>
                    <span class="docs-mini">K</span>
                </h6>

                <!-- Categories -->
                <ul class="navbar-nav">
                    {% for category in sidebar_categories %}
                    <li class="nav-item">
                        {% if category.slug == 'spd' %}
                            <a class="nav-link {% if request.resolver_match.url_name == 'spd_list' %}active{% endif %}"
                            href="{% url 'archive:spd_list' %}">
                                <i class="fa-solid {{ category.icon }} text-warning"></i>
                                <span class="nav-link-text">{{ category.name }}</span>
                                <span class="{% get_badge_class category.slug %} badge-sm ml-auto">
                                    {{ category.parent_docs|add:category.children_docs }}
                                </span>
                            </a>
                        {% else %}
                            <a class="nav-link {% if request.resolver_match.kwargs.category_slug == category.slug %}active{% endif %}"
                            href="{% url 'archive:document_list_by_category' category.slug %}">
                                <i class="fa-solid {{ category.icon }} text-success"></i>
                                <span class="nav-link-text">{{ category.name }}</span>
                                <span class="{% get_badge_class category.slug %} badge-sm ml-auto">
                                    {{ category.parent_docs|add:category.children_docs }}
                                </span>
                            </a>
                        {% endif %}
                        
                        <!-- Subcategories (Children) -->
                        {% if category.children.exists %}
                            {% for child in category.children.all %}
                            <li class="nav-item">
                                <a class="nav-link {% if request.resolver_match.kwargs.category_slug == child.slug %}active{% endif %}"
                                href="{% url 'archive:document_list_by_category' child.slug %}">
                                    <i class="fa-solid {{ child.icon }} text-default"></i>
                                    <span class="nav-link-text">{{ child.name }}</span>
                                    <span class="badge badge-sm badge-default badge-pill ml-auto">
                                        {{ child.children_docs|default:"0" }}
                                    </span>
                                </a>
                            </li>
                            {% endfor %}
                        {% endif %}
                        <ul class="nav nav-sm flex-column">
                        </ul>
                    </li>
                    {% empty %}
                    <li class="nav-item">
                        <span class="nav-link text-muted">
                            <span class="nav-link-text">Belum ada kategori</span>
                        </span>
                    </li>
                    {% endfor %}
                </ul>

                <!-- Divider -->
                <hr class="my-3">
                
                <!-- Lainnya Heading -->
                <h6 class="navbar-heading p-0 text-muted">
                    <span class="docs-normal">Lainnya</span>
                    <span class="docs-mini"> L </span>
                </h6>

                <!-- Opsi Lain -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#navbar-others" data-toggle="collapse" role="button" aria-expanded="false" aria-controls="navbar-others">
                            <i class="fa-solid fa-gear text-default"></i>
                            <span class="nav-link-text">Lainnya</span>
                        </a>
                        <div class="collapse" id="navbar-others">
                            <ul class="nav nav-sm flex-column">
                                <li class="nav-item">
                                    <!-- Pegawai -->
                                    <a href="{% url 'archive:employee_list' %}" class="nav-link {% if request.resolver_match.url_name == 'employee' %}active{% endif %}">
                                        <span class="sidenav-mini-icon"> E </span>
                                        <span class="sidenav-normal">Manajemen Pegawai</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <!-- Pengguna -->
                                    <a href="{% url 'accounts:user_list' %}" class="nav-link">
                                        <span class="sidenav-mini-icon"> U </span>
                                        <span class="sidenav-normal">Manajemen Pengguna</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <!-- Test -->
                                    <a href="{% url 'archive:test' %}" class="nav-link {% if request.resolver_match.url_name == 'test' %}active{% endif %}">
                                        <span class="sidenav-mini-icon"> T </span>
                                        <span class="sidenav-normal">Halaman Testing</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>

                <!-- Divider -->
                <hr class="my-3">
                
                <!-- Upload Heading -->
                <h6 class="navbar-heading p-0 text-muted">
                    <span class="docs-normal">Upload</span>
                    <span class="docs-mini"> U </span>
                </h6>
                
                <!-- Upload Actions -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#navbar-uploads" data-toggle="collapse" role="button" aria-expanded="false" aria-controls="navbar-uploads">
                            <i class="fa-solid fa-circle-plus text-default"></i>
                            <span class="nav-link-text">Upload</span>
                        </a>
                        <div class="collapse" id="navbar-uploads">
                            <ul class="nav nav-sm flex-column">
                                <li class="nav-item">
                                    <!-- Belanjaan -->
                                    <a href="#" class="nav-link" data-action="upload-document">
                                        <span class="sidenav-mini-icon"> B </span>
                                        <span class="sidenav-normal">Upload Belanjaan</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <!-- SPD -->
                                    <a href="#" class="nav-link" data-action="upload-spd">
                                        <span class="sidenav-mini-icon"> S </span>
                                        <span class="sidenav-normal">Upload SPD</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</nav>